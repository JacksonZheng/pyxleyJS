!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports.Pxyley=e():t.Pxyley=e()}(this,function(){return function(t){function e(a){if(n[a])return n[a].exports;var i=n[a]={exports:{},id:a,loaded:!1};return t[a].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(2).FilterChart,i=n(3).Filter,s=n(2).Chart;e["default"]={Filter:i,Chart:s,FilterChart:a},t.exports=e["default"]},function(t,e){"use strict";var n=ReactBootstrap.DropdownButton,a=ReactBootstrap.Button,i=React.createClass({displayName:"SelectButton",getDefaultProps:function(){return{options:React.PropTypes.object,dynamic:!1,onChange:React.PropTypes.func}},getInitialState:function(){return{value:null,selected:0}},getCurrentState:function(){var t={};return t[this.props.options.alias]=this.state.value||this.props.options["default"],t},_handleClick:function(t,e,n){if(n.preventDefault(),this.setState({selected:t,value:e}),this.refs.btn.setDropdownState(!1),this.props.dynamic){var a={alias:this.props.options.alias,value:e};this.props.onChange([a])}},render:function(){var t=this.props.options.items.map(function(t,e){return React.createElement("li",{onClick:this._handleClick.bind(null,e,t),key:e},React.createElement("a",{href:"#"},t))}.bind(this)),e=this.state.value||this.props.options.label;return React.createElement(n,{ref:"btn",title:e},t)}}),s=React.createClass({displayName:"ConditionalSelectButton",getDefaultProps:function(){return{options:React.PropTypes.object,dynamic:!1,onChange:React.PropTypes.func}},getInitialState:function(){return{value:null,selected:0}},_handleClick:function(t,e,n){if(n.preventDefault(),this.setState({selected:t,value:e}),this.refs.primary.setDropdownState(!1),this.props.dynamic){var a=[{alias:this.props.options.aliases[0],value:e},{alias:this.props.options.aliases[1],value:"All"}];this.props.onChange(a)}this.refs.secondary.setState({value:"All"})},getCurrentState:function(){var t={};return t[this.props.options.aliases[0]]=this.state.value||this.props.options.defaults[0],t[this.props.options.aliases[1]]=this.refs.secondary.state.value||this.props.options.defaults[1],t},render:function(){var t=this.props.options.items.map(function(t,e){return React.createElement("li",{onClick:this._handleClick.bind(null,e,t.primary),key:e},React.createElement("a",{href:"#"},t.primary))}.bind(this)),e=this.state.value||this.props.options.labels[0],a={items:this.props.options.items[this.state.selected].secondary,label:this.props.options.labels[1],alias:this.props.options.aliases[1],"default":this.props.options.defaults[1]};return React.createElement("div",{className:this.props.options.filter_style},React.createElement(n,{ref:"primary",title:e},t),React.createElement(i,{ref:"secondary",onChange:this.props.onChange,dynamic:this.props.dynamic,options:a}))}}),o=React.createClass({displayName:"ApiButton",getDefaultProps:function(){return{options:React.PropTypes.object,dynamic:!1,onChange:React.PropTypes.func}},getInitialState:function(){return{items:[]}},getCurrentState:function(){return this.refs.apiBtn.getCurrentState()},componentDidMount:function(){this._fetchAPIData()},_fetchAPIData:function(){$.get(this.props.options.url,function(t){this.setState({items:t.data})}.bind(this))},render:function(){var t={items:this.state.items,alias:this.props.options.alias,"default":this.props.options["default"],title:this.props.options.title};return React.createElement(i,{ref:"apiBtn",onChange:this.props.onChange,dynamic:this.props.dynamic,options:t})}}),r=React.createClass({displayName:"DownloadButton",getDefaultProps:function(){return{options:React.PropTypes.object,dynamic:!1,onChange:React.PropTypes.func}},getCurrentState:function(){return null},_onClick:function(){var t=this.props.onChange();window.location.href=this.props.options.url.concat("?",$.param(t))},render:function(){return React.createElement(a,{onClick:this._onClick},this.props.options.label)}});t.exports.ConditionalSelectButton=s,t.exports.SelectButton=i,t.exports.ApiButton=o,t.exports.DownloadButton=r},function(t,e,n){"use strict";var a=n(6).LinePlot,i=n(9).Table,s=n(3).Filter,o=ReactBootstrap.Row,r=ReactBootstrap.Button,p=n(4).Datamaps,c=n(7).MetricsGraphics,l=function f(t){if("function"!=typeof f[t])throw new Error(t+" is not a valid chart type.");return f[t]};l.LinePlot=a,l.Table=i,l.Datamaps=p,l.MetricsGraphics=c;var u=React.createClass({displayName:"Chart",getDefaultProps:function(){return{type:React.PropTypes.string.isRequired,options:React.PropTypes.object}},update:function(t){this.refs.chart._update(t)},render:function(){var t=l(this.props.type);return React.createElement(t,{ref:"chart",options:this.props.options})}}),h=React.createClass({displayName:"FilterChart",getDefaultProps:function(){return{filters:React.PropTypes.array,filter_style:React.PropTypes.string,charts:React.PropTypes.array,dynamic:React.PropTypes.string}},_handleClick:function(t){for(var e={},n=0;n<this.props.filters.length;n++){var a=this.refs["filter_".concat(n)].refs.filter.getCurrentState();for(var i in a)e[i]=a[i]}if(t)for(var n=0;n<t.length;n++)e[t[n].alias]=t[n].value;for(var n=0;n<this.props.charts.length;n++)this.refs["chart_".concat(n)].update(e);return e},render:function(){var t=this.props.filters.map(function(t,e){return React.createElement(s,{ref:"filter_".concat(e),onChange:this._handleClick,dynamic:this.props.dynamic,type:t.type,options:t.options})}.bind(this)),e=this.props.charts.map(function(t,e){return React.createElement(u,{ref:"chart_".concat(e),type:t.type,options:t.options})});return React.createElement("div",null,React.createElement(o,null,React.createElement("div",{className:this.props.filter_style},this.props.dynamic?null:React.createElement(r,{onClick:this._handleClick},"Update!"),t)),React.createElement(o,null,e))}});t.exports.FilterChart=h},function(t,e,n){"use strict";var a=n(1).SelectButton,i=n(1).DownloadButton,s=n(1).ConditionalSelectButton,o=n(1).ApiButton,r=n(8).SliderInput,p=n(5).DynamicSearch,c=function u(t){if("function"!=typeof u[t])throw new Error(t+" is not a valid filter.");return u[t]};c.SliderInput=r,c.SelectButton=a,c.ConditionalSelectButton=s,c.ApiButton=o,c.DownloadButton=i,c.DynamicSearch=p;var l=React.createClass({displayName:"Filter",getDefaultProps:function(){return{type:React.PropTypes.string.isRequired,options:React.PropTypes.object,dynamic:!1,onChange:React.PropTypes.func}},render:function(){var t=c(this.props.type);return React.createElement(t,{ref:"filter",dynamic:this.props.dynamic,onChange:this.props.onChange,options:this.props.options})}});t.exports.Filter=l},function(t,e){"use strict";var n=React.createClass({displayName:"Datamaps",getDefaultProps:function(){return{options:React.PropTypes.object}},getInitialState:function(){return{chart:null}},componentDidMount:function(){this._initialize(this.props.options.params)},_initialize:function(t){$.get(this.props.options.url.concat("?",$.param(t)),function(t){this.state.chart=new Datamap({element:document.getElementById(this.props.options.chartid),scope:"usa",fills:t.fills,data:t.data})}.bind(this))},_update:function(t){$.get(this.props.options.url.concat("?",$.param(t)),function(t){this.state.chart.updateChoropleth(t.data)}.bind(this))},render:function(){return React.createElement("div",{id:this.props.options.chartid,className:"pyDataMap"})}});t.exports.Datamaps=n},function(t,e,n){"use strict";var a=ReactBootstrap.Input,i=ReactBootstrap.DropdownMenu,s=ReactBootstrap.DropdownStateMixin,o=ReactBootstrap.BootstrapMixin,r=ReactBootstrap.MenuItem,p=n(10),c=React.createClass({displayName:"DynamicSearch",mixins:[s,o],getDefaultProps:function(){return{options:React.PropTypes.object,dynamic:!1,onChange:React.PropTypes.func}},getInitialState:function(){return{value:null,searchString:"",items:[]}},getCurrentState:function(){var t={};return t[this.props.options.alias]=this.state.value||this.props.options["default"],t},componentDidMount:function(){this._fetchAPIData()},_fetchAPIData:function(){$.get(this.props.options.url,function(t){this.setState({items:t.data})}.bind(this))},_filterItems:function(){var t=this.state.items,e=this.state.searchString.trim().toLowerCase();e.length>0&&(t=t.filter(function(t){return t.toLowerCase().match(e)}));var n=t.length,a="Results Left: #";return t.map(function(t,e){return e<this.props.options.max?React.createElement(r,{key:e,onSelect:this._handleItemSelect.bind(null,t)},t):e==this.props.options.max?React.createElement(r,{key:e},a.replace("#",n-e)):void 0}.bind(this))},_handleChange:function(t){t.preventDefault(),this.setState({searchString:t.target.value,value:t.target.value}),this.setDropdownState(!0)},_handleItemSelect:function(t,e){if(this.setState({value:t}),this.setDropdownState(!this.state.open),this.props.dynamic){var n={alias:this.props.options.alias,value:t};this.props.onChange([n])}},render:function(){var t={dropdown:!0,open:this.state.open};return React.createElement("div",{className:p(t)},React.createElement(a,{type:"text",ref:"input",value:this.state.value,placeholder:this.props.options.placeholder,help:this.props.options.help,onChange:this._handleChange}),React.createElement(i,{ref:"menu",key:1,"aria-labelledby":this.props.id,pullRight:!1},this._filterItems()))}});t.exports.DynamicSearch=c},function(t,e){"use strict";var n=React.createClass({displayName:"LinePlot",getDefaultProps:function(){return{options:React.PropTypes.object}},getInitialState:function(){return{chart:null}},componentDidMount:function(){this.setState({chart:this._initialize(this.state.chart)})},_initialize:function(t){return t=nv.models.lineChart().margin(this.props.options.margin||{left:100}).useInteractiveGuideline(!0).showLegend(!0).showYAxis(!0).showXAxis(!0),t.xAxis.axisLabel("X Axis").tickFormat(d3.format(",r")),t.yAxis.axisLabel("Y Axis").tickFormat(d3.format(".02f")),d3.json(this.props.options.url,function(e,n){d3.select("#".concat(this.props.options.chartid," svg")).datum(n.result).call(t)}.bind(this)),nv.utils.windowResize(function(){t.update()}),t},_update:function(t){d3.json(this.props.options.url.concat("?",$.param(t)),function(t,e){d3.select("#".concat(this.props.options.chartid," svg")).datum(e.result).transition().duration(500).call(this.state.chart),nv.utils.windowResize(function(){this.state.chart.update()}.bind(this))}.bind(this))},render:function(){return React.createElement("div",{id:this.props.options.chartid},React.createElement("svg",null))}});t.exports.LinePlot=n},function(t,e){"use strict";var n=React.createClass({displayName:"MetricsGraphics",getDefaultProps:function(){return{options:React.PropTypes.object}},_fixBoolOptions:function(t){var e={};for(var n in t)"string"==typeof t[n]&&("true"==t[n]||"false"==t[n])?e[n]="true"==t[n]:e[n]=t[n];return e},componentDidMount:function(){this._initialize(this.props.options.params.init_params)},_initialize:function(t){d3.json(this.props.options.url.concat("?",$.param(t)),function(t,e){var n=this._fixBoolOptions(this.props.options.params);if("true"==e.date)for(var a=0;a<e.result.length;a++)e.result[a]=MG.convert.date(e.result[a],"x");n.data=e.result,MG.data_graphic(n)}.bind(this))},_update:function(t){d3.json(this.props.options.url.concat("?",$.param(t)),function(t,e){var n=this._fixBoolOptions(this.props.options.params);if("true"==e.date)for(var a=0;a<e.result.length;a++)e.result[a]=MG.convert.date(e.result[a],"x");n.data=e.result,MG.data_graphic(n)}.bind(this))},render:function(){var t={width:this.props.options.params.width};return React.createElement("div",{id:this.props.options.chart_id,style:t})}});t.exports.MetricsGraphics=n},function(t,e){"use strict";var n=React.createClass({displayName:"SliderInput",getDefaultProps:function(){return{options:React.PropTypes.object,dynamic:!1,onChange:React.PropTypes.func}},getInitialState:function(){return{value:null}},getCurrentState:function(){var t={};return t[this.props.options.alias]=this.state.value||this.props.options["default"],t},_handleChange:function(t){t.preventDefault();var e=this.getDOMNode();if(this.setState({value:e.value}),this.props.dynamic){var n={alias:this.props.options.alias,value:e.value};this.props.onChange([n])}},render:function(){return React.createElement("input",{id:"pyx-slider",className:"pyx-slider",ref:"slider",type:"range",name:this.props.options.label,min:this.props.options.min,max:this.props.options.max,onInput:this._handleChange,step:this.props.options.step})}});t.exports.SliderInput=n},function(t,e){"use strict";var n=React.createClass({displayName:"Table",getDefaultProps:function(){return{options:{leftFixed:0,rightFixed:0,table_options:{deferRender:!0,paging:!1,scrollX:!0,bSort:!1,sDom:'<"top">rt<"bottom"lp><"clear">'},id:"mytable",url:"",params:{}}}},getInitialState:function(){return{columns:[]}},componentDidMount:function(){this._initialize()},_checkTableOptions:function(t){var e={};for(var n in t)"string"==typeof t[n]&&("true"==t[n]||"false"==t[n])?e[n]="true"==t[n]:e[n]=t[n];return e},_initialize:function(){$.get(this.props.options.url.concat("?",$.param(this.props.options.params)),function(t){this.setState({columns:t.columns});var e=this._checkTableOptions(this.props.options.table_options);e.data=t.data,e.columns=t.columns,e.aaData=t.data;var n=$("#".concat(this.props.options.id)).dataTable(e);this.props.options.leftFixed+this.props.options.rightFixed>0&&new $.fn.dataTable.FixedColumns(n,{leftColumns:this.props.options.leftFixed,rightColumns:this.props.options.rightFixed})}.bind(this))},_update:function(t){var e=$("#".concat(this.props.options.id)).DataTable();e.ajax.url(this.props.options.url.concat("?",$.param(t))).load()},render:function(){var t=this.state.columns.map(function(t,e){return React.createElement("th",{key:e},t.data)});return React.createElement("div",null,React.createElement("table",{id:this.props.options.id,className:"display",cellSpacing:"0",width:"100%"},React.createElement("thead",null,React.createElement("tr",null,t))))}});t.exports.Table=n},function(t,e,n){var a;/*!
	  Copyright (c) 2015 Jed Watson.
	  Licensed under the MIT License (MIT), see
	  http://jedwatson.github.io/classnames
	*/
!function(){"use strict";function i(){for(var t="",e=0;e<arguments.length;e++){var n=arguments[e];if(n){var a=typeof n;if("string"===a||"number"===a)t+=" "+n;else if(Array.isArray(n))t+=" "+i.apply(null,n);else if("object"===a)for(var s in n)n.hasOwnProperty(s)&&n[s]&&(t+=" "+s)}}return t.substr(1)}a=function(){return i}.call(e,n,e,t),!(void 0!==a&&(t.exports=a))}()}])});